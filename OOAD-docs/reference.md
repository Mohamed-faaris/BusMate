This reference document summarizes the BusMate project structure, primary modules, REST API endpoints, Drizzle ORM schema, and main UX flows to help produce the OOAD documentation. BusMate is a modern Next.js (App Router) application that facilitates campus bus seat booking. The project uses NextAuth for authentication with a Credentials provider and Drizzle ORM with PostgreSQL as the data layer. The app is built with TypeScript and uses React 19, TanStack Query for data synchronization, Tailwind CSS and Radix UI primitives for UI, and PostHog for analytics instrumentation where configured.

Server-side entry points and request handlers are located under `src/app/api`. Key API routes are: `POST /api/register` which validates input and creates a user and credentials; `POST /api/register/otp/*` endpoints support a demo OTP flow; `GET /api/boarding-points` and `GET /api/busRoutes` which return boarding points and route metadata; `GET /api/bus/byBoardingPoint/[boardingPointId]` which lists buses for a boarding point; `GET /api/bus/[busId]` returning bus details and an embedded model layout; `POST /api/bookSeat` that handles seat booking and updates both `BusMate_seat` and the `buses.seats` JSON map. Admin routes under `src/app/api/admin` include `addBoardingPoints`, `addModel`, `addBus`, `userDetails`, and `dashboard` endpoints to support management workflows.

Authentication is implemented using NextAuth, configured in `src/server/auth/config.ts`, with a Credentials provider that verifies email and password hashes against the `account` table. The `auth` helper exported from `src/server/auth/index.ts` is used in API routes to protect endpoints like `/api/bookSeat` and `/api/dashboard`.

The data model is defined with Drizzle ORM in `src/server/db/schema`. Key tables include `user` (BusMate_user), `account` (BusMate_account), `boardingPoint` (BusMate_boardingPoint), `bus` (BusMate_bus), `seat` (BusMate_seat), `busBoardingPoint` (BusMate_busBoardingPoint), `model` (BusMate_model), and `acceptedRolls`. Enums are defined in `enums.ts` such as `gender` and `seatStatus`. The `bus.seats` column stores a JSON map of seat identifiers to `seatStatus` values to improve read performance for seat availability. Seat booking is recorded both in `BusMate_seat` and reflected back into the `buses.seats` JSON column to avoid full table scans for seat availability.

UI components and client-side logic are organized under `src/app` and `src/components`. The dashboard and booking UI live under `src/app/dashboard`, with the booking page at `src/app/dashboard/booking/BookingPage.tsx`. A reusable bus seat map component is implemented at `src/components/bus/Bus.tsx` and associated seat components under `src/components/bus/seats`. Admin UI is under `src/app/admin` with subpages for managing models, buses, and boarding points. Shared UI primitives are provided in `src/components/ui` and include Radix/Headless-style components wrapped with Tailwind classes.

The project relies on environment validation from `src/env.js` to ensure required server-side and client-side environment variables are present. Emails are sent through a `mailer` module under `src/server/mailer/index.ts`, configured to use SMTP with Gmail by environment variables. Redis utilities for caching and session helpers live in `src/server/redis`.

The README contains helpful quick-start instructions and pointers for DB setup using Drizzle and Docker and lists commonly used scripts such as `pnpm db:push`, `pnpm db:studio`, `pnpm dev`, and `pnpm preview`. The appâ€™s schema and endpoints are suitable for seeding with Drizzle Studio or programmatically via admin endpoints. The `package.json` lists a modern stack that includes Drizzle ORM, NextAuth, TanStack Query, Postgres driver, Redis, and PostHog.

This reference consolidates the exact schema types, key endpoint names, module file paths, major UI flows, and primary tech stack decisions to be used as the canonical project summary when crafting the OOAD document in `OOAD.md`. For deeper detail the `src/server/db/schema` files should be referenced, as they provide precise column, type, and constraint data.